app.on('web-contents-created', (event, webContents) => {
    webContents.on('select-bluetooth-device', (event, devices, callback) => {
      // Prevent default behavior
      event.preventDefault();
      // Cancel the request
      callback('');
    });
  });

  // Bad
ipcMain.handle('get-secrets', () => {
    return getSecrets();
  });
  
  // Good
  ipcMain.handle('get-secrets', (e) => {
    if (!validateSender(e.senderFrame)) return null;
    return getSecrets();
  });
  
  function validateSender(frame) {
    // Value the host of the URL using an actual URL parser and an allowlist
    if ((new URL(frame.url)).host === 'electronjs.org') return true;
    return false;
  }
  app.on('web-contents-created', (e, webContents) => {
  webContents.on('will-redirect', (e, url) => {
    if (/^file:/.test(url)) e.preventDefault()
  })
})